<div class="flex">
  <app-section title="Refine Feed" [active]="!hasChosen">
    <aside class="aside">
      <div>
        <div
          class="field"
          *ngIf="nativeFeed"
          [ngClass]="{ 'is-hidden': hasChosen }"
        >
          <label class="label">Feed URL</label>
          <a
            [href]="nativeFeed.url"
            referrerpolicy="no-referrer"
            target="_blank"
            >{{ nativeFeed.title }}</a
          >
        </div>
        <div
          class="field mb-6"
          *ngIf="genericFeedRule"
          [ngClass]="{ 'is-hidden': hasChosen }"
        >
          <label class="label">Feed URL</label>
          <a
            [href]="genericFeedRule.feedUrl"
            referrerpolicy="no-referrer"
            target="_blank"
            >Generic Feed</a
          >
        </div>

        <div class="field" *ngIf="!hasChosen">
          <label class="label">Content Mapping</label>
          <div class="control">
            <div class="select is-expanded">
              <select
                [(ngModel)]="contentResolution"
                class="is-expanded"
                [ngClass]="{ 'is-primary': contentResolution !== 'none' }"
              >
                <option value="default">default</option>
<!--                <option value="fulltext">fulltext</option>-->
                <option value="oc">OG Tags</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field" *ngIf="hasChosen">
          <label class="label">Content Mapping</label>
          <div class="control">
            <em>{{ contentResolution }}</em>
          </div>
        </div>

        <div class="field" *ngIf="!hasChosen">
          <label class="label">Filter</label>
          <div class="select is-expanded">
            <select class="is-expanded">
              <option
                *ngFor="let filterSample of filterSamples"
                [value]="filterSample.value"
              >
                {{ filterSample.name }}
              </option>
            </select>
          </div>
          <div class="control">
            <textarea
              class="textarea"
              [ngClass]="{ 'is-primary': filter.length > 0 }"
              [(ngModel)]="filter"
            ></textarea>
            <em>{{ filter }}</em>
          </div>
          <button class="button is-expanded" (click)="apply()">Apply</button>
        </div>

        <div class="field" *ngIf="hasChosen">
          <label class="label">Filter</label>
          <div class="control">
            <em *ngIf="filter">{{ filter }}</em>
            <em *ngIf="!filter">no filter</em>
          </div>
        </div>

        <label
          class="label mt-6 is-primary"
          [ngClass]="{ 'is-hidden': hasChosen }"
          >Continue</label
        >
        <ul class="menu-list">
          <li>
            <a [ngClass]="{ 'is-active': feedUrls }" (click)="useFeedUrls()"
              >Feed URLs</a
            >
          </li>
          <li>
            <a
              [ngClass]="{ 'is-active': pushUpdates }"
              (click)="usePushUpdate()"
              >Push Updates</a
            >
          </li>
        </ul>
      </div>
    </aside>

    <div class="feed source" [ngClass]="{ 'is-hidden': hasChosen }">
      <app-spinner *ngIf="!jsonFeed"></app-spinner>
      <app-feed [jsonFeed]="jsonFeed" *ngIf="jsonFeed"></app-feed>
    </div>
  </app-section>

  <app-convert-format
    *ngIf="feedUrls"
    class="flex"
    [nativeFeed]="createNativeFeedWithParams()"
    [genericFeedRule]="createGenericFeedRuleWithParams()"
  ></app-convert-format>
  <app-push-updates
    *ngIf="pushUpdates"
    class="flex"
    [nativeFeed]="createNativeFeedWithParams()"
    [genericFeed]="createGenericFeedRuleWithParams()"
  ></app-push-updates>
</div>
